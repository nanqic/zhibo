<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加老师</title>
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.css"/>
</head>
<body>
<script src="/js/axios.min.js" type="text/javascript"></script>
<script src="/bootstrap/js/bootstrap.bundle.js" type="text/javascript"></script>
<div class="container">
    <form class="row mt-5">
        <div class="input-group mb-3">
            <label for="name" class="form-label">姓名：</label>
            <input id="name" type="text" class="form-control" placeholder="请输入学生姓名" required maxlength="8">
        </div>
        <div class="input-group mb-3">
            <label for="username" class="form-label">学号：</label>
            <input id="username" type="text" class="form-control" placeholder="请输入学生工号" required maxlength="12">
        </div>
        <div class="input-group mb-3">
            <label for="phone" class="form-label">手机：</label>
            <input id="phone" type="tel" class="form-control" placeholder="请输入学生手机号" maxlength="11" required>
        </div>
        <div class="input-group mb-3">
            <label for="dept" class="form-label">系部：</label>
            <select class="form-select" id="dept">
                <option selected>请选择学生系部...</option>
                <option value="1">人工智能学院</option>
                <option value="2">信息技术系</option>
            </select>
        </div>
        <div class="input-group mb-3">
            <label for="major" class="form-label">专业：</label>
            <select class="form-select" id="major">
                <option selected>请选择学生专业...</option>
                <option value="1">计算机科学与技术</option>
                <option value="2">软件工程</option>
                <option value="3">计算机网络</option>
                <option value="4">计算机应用</option>
            </select>
        </div>
        <div class="input-group mb-3">
            <label for="major" class="form-label">指导老师：</label>
            <select class="form-select" id="teacher" required>
                <option selected>请选择指导老师...</option>
            </select>
        </div>
        <div class="input-group mb-3">
            <label for="class-name" class="form-label">班级：</label>
            <select class="form-select" id="class-name">
                <option selected>请选择学生班级...</option>
                <option value="1">计科211</option>
                <option value="2">软工212</option>
                <option value="3">计网213</option>
                <option value="4">计应214</option>
            </select>
        </div>
        <div class="input-group mb-3">
            <label for="graduation" class="form-label">毕业年份：</label>
            <input id="graduation" type="number" class="form-control" placeholder="请输入学生毕业年份" required>
        </div>
        <div class="d-flex justify-content-lg-center">
            <button type="button" class="btn btn-primary mb-3" onclick="doSubmit()">确认提交</button>
        </div>
        <script>
            initTeachers()
            function initTeachers(){
                axios.get("/admin/teachers")
                .then(resp=>{
                    // console.log(resp.data.data)
                    const data = resp.data.data
                    const teacherNode = document.getElementById('teacher')
                    let opt = document.createElement('option')
                    const length = data.length
                    for(let i=0;i<=length-1;i++){
                        teacherNode.appendChild(opt.cloneNode())
                        teacherNode.children[i+1].value = data[i].uid
                        teacherNode.children[i+1].innerHTML = data[i].name
                    }
                })
            }
            function doSubmit() {
                let data = {
                    username: document.getElementById('username').value,
                    teacherUid: document.getElementById('teacher').value,
                    studentInfo: {
                        name: document.getElementById('name').value,
                        phone: document.getElementById('phone').value,
                        deptId: document.getElementById('dept').value,
                        majorId: document.getElementById('major').value,
                        classId: document.getElementById('class-name').value,
                        graduation: document.getElementById('graduation').value,
                    }
                }
                // console.log(data)
                axios({
                    method: 'post',
                    url: '/admin/s',
                    data: data
                })
                    .then(resp => {
                        if(resp.data.msg == 'ok'){
                            alert('添加学生成功！')
                        }
                    })
                .then(()=> location.replace('userList.html'))
            }

        </script>
    </form>
</div>
</body>
</html>