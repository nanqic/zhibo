<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.css"/>
</head>

<body>
<div class="container">
    <table class="table">
        <thead>
        <tr>
            <th scope="col">指导教师</th>
            <th scope="col">课题名称</th>
            <th scope="col">录取状态</th>
            <th scope="col">操作</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="table-warning"></td>
            <td class="table-info"></td>
            <td class="table-success"></td>
            <td>
                <button class="btn btn-warning" onclick="abort()">退选志愿</button>
            </td>
        </tr>

        </tbody>
    </table>
</div>
<script src="/js/axios.min.js"></script>
<script src="/bootstrap/js/bootstrap.bundle.js"></script>
<script>
    loadData()
    let did

    // 查询志愿信息
    function loadData() {
        axios("/student/aspir")
            .then(resp => {
                if (resp.data.data != null) {
                    const data = resp.data.data
                    did = resp.data.data.did
                    // console.log(data)
                    let status = data.status == 0 ? '未录取' : '已录取'
                    // console.log(status);
                    const teacherTd = document.querySelector('.table-warning')
                    const nameTd = document.querySelector('.table-info')
                    const statusTd = document.querySelector('.table-success')
                    teacherTd.innerHTML = data.teacher
                    nameTd.innerHTML = '《 ' + data.name + ' 》'
                    statusTd.innerHTML = status
                } else {
                    let container = document.querySelector('.container')
                    let table = document.querySelector('.table')
                    container.removeChild(table)
                    container.innerHTML = '未选择志愿'
                }

            })
    }

    function abort() {
        if (confirm("确认退选论文吗？")) {
            axios('/student/abort?did=' + did)
                .then(resp => {
                    if (resp.data.status == 200) {
                        alert("退选成功！")
                        location.reload()
                    } else {
                        alert("退选失败")
                    }
                })
        }

    }
</script>

</body>

</html>